AI Context: Redirect Event Handlers (website-builder/event-handler/redirects.mdx)

Source of Information:
1. Read /Users/brunozoric/work/webiny/webiny-beta-test/testing-v6.0.0/extensions/websiteBuilder/redirects/eventHandler
2. Analyzed existing redirect event handler implementations
3. Examined redirect lifecycle events (create, update, delete)
4. Studied redirect-specific validation (URLs, status codes, patterns)
5. Followed the established event handler pattern

Key Documentation Decisions:
- Document all redirect lifecycle events
- Follow the established event handler pattern (logger, Result)
- Include redirect-specific validations (URL format, status codes, circular redirects)
- Show practical examples for each event type
- Demonstrate validation patterns
- Cover error handling

Events Documented:
1. Before Create - Validation before redirect creation (URL format, status code, circular redirect check)
2. After Create - Post-creation actions (cache invalidation, logging)
3. Before Update - Validation before updates (breaking changes, conflicts)
4. After Update - Post-update actions (cache refresh)
5. Before Delete - Authorization checks
6. After Delete - Cleanup operations (cache invalidation)

Pattern Used:
- Logger from @webiny/api/logger
- Result pattern for validation errors
- Redirect-specific validation logic
- URL format validation
- Status code validation (301, 302, 307, 308)
- Circular redirect detection
- Pattern matching validation

Redirect-Specific Validations:
- Source URL format
- Target URL validation
- Valid HTTP status codes
- Circular redirect prevention
- Wildcard pattern validation
- Duplicate redirect checks

Target Audience: Developers extending redirect behavior, implementing custom redirect rules, or building redirect management tools.

Note: Corrected folder path after initial error (/redirects/ not /redirect/).

Related Documents:
- website-builder/event-handler/pages.mdx - Similar website builder patterns
- website-builder/use-case/redirects.mdx - Use case integration

Key Code Locations:
- Source: /Users/brunozoric/work/webiny/webiny-beta-test/testing-v6.0.0/extensions/websiteBuilder/redirects/eventHandler
- Symlinked: remote/websiteBuilder/redirects/eventHandler

Redirect Event Handler Pattern:
```typescript
import { logger } from "@webiny/api/logger";
import { Result } from "@webiny/feature/api";

export const RedirectBeforeCreateEventHandler = async ({ redirect, context }) => {
    logger.info("Before creating redirect", {
        source: redirect.source,
        target: redirect.target
    });

    // URL format validation
    if (!redirect.source.startsWith("/")) {
        return Result.fail(new ValidationError("Source must start with /"));
    }

    // Status code validation
    const validCodes = [301, 302, 307, 308];
    if (!validCodes.includes(redirect.statusCode)) {
        return Result.fail(new ValidationError("Invalid status code"));
    }

    // Circular redirect detection
    const wouldCreateCircular = await checkCircular(redirect, context);
    if (wouldCreateCircular) {
        return Result.fail(new ValidationError("Would create circular redirect"));
    }
};
```

Redirect-Specific Validations:
1. Source URL format (must start with /)
2. Target URL validation
3. Valid HTTP status codes (301, 302, 307, 308)
4. Circular redirect detection
5. Wildcard pattern validation
6. Duplicate redirect checks

Status Codes:
- 301: Permanent redirect
- 302: Temporary redirect
- 307: Temporary redirect (preserves method)
- 308: Permanent redirect (preserves method)

Events to Document:
1. Before Create - URL format, status code, circular check
2. After Create - Cache invalidation, logging
3. Before Update - Validation of changes, conflict check
4. After Update - Cache refresh
5. Before Delete - Authorization
6. After Delete - Cache cleanup

Common Patterns:
1. Validate URL formats
2. Check status code validity
3. Detect circular redirects
4. Prevent duplicate redirects
5. Invalidate caches on changes

Circular Redirect Detection:
```typescript
// Check if source would redirect to itself through chain
// A → B → A (circular)
```

Tone Guidelines:
- Focus on redirect-specific concerns
- Explain status codes
- Show circular detection logic
- Production validation patterns

